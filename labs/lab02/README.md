# Избыточность локальных сетей. STP

##  Задание:
Настройка STP
Цель: Создание сети и настройка основных параметров устройства
Выбор корневого моста
Наблюдение за процессом выбора протоколом STP порта, исходя из стоимости портов
Наблюдение за процессом выбора протоколом STP порта, исходя из приоритета портов
В этой лабораторной работе вам предстоит настроить протокол Cisco STP, являющийся протоколом FHRP.
В части 1 вам предстоит настроить топологию сети и основные параметры маршрутизаторов.
В части 2 Для каждого экземпляра протокола spanning-tree (коммутируемая сеть LAN или широковещательный домен) существует коммутатор, выделенный в качестве корневого моста.
В части 3 Наблюдение за процессом выбора протоколом STP порта, исходя из стоимости портов.
В части 4 вам предстоит активировать избыточные пути до каждого из коммутаторов, чтобы просмотреть, каким образом протокол STP выбирает порт с учетом приоритета портов.

##  Решение:

##### Лабораторная работа выполнена на базе Cisco Packet Tracer.

##### Схема сети:

![]()

#### Часть 1:	Создание сети и настройка основных параметров устройства

В части 1 настраиваем топологию сети и основные параметры маршрутизаторов.
#### Шаг 1:	Создаем сеть согласно топологии.
Подключаем устройства, как показано в топологии, и подсоединяем необходимые кабели.
#### Шаг 2:	Выполняем инициализацию и перезагрузку коммутаторов.
#### Шаг 3:	Настраиваем базовые параметры каждого коммутатора.
a.	Отключаем поиск DNS.
```
no ip domain-lookup
```
b.	Присваиваем имена устройствам в соответствии с топологией.
```
hostname S1/S2/S3
```
c.	Назначаем **class** в качестве зашифрованного пароля доступа к привилегированному режиму.
```
enable secret class
```
d.	Назначаем **cisco** в качестве паролей консоли и VTY и активируем вход для консоли и VTY каналов.
```
line con 0
login
password cisco
exit
line vty 0 4
login
password cisco
exit
```
e.	Настроим **logging synchronous** для консольного канала.
```
line con 0
login synchronous
exit
```
f.	Настроим баннерное сообщение дня (MOTD) для предупреждения пользователей о запрете несанкционированного доступа.
```
banner login ^C Accessing the device that unauthorized access is prohibited ^C
```
g.	Задаем IP-адреса, указанные в таблице адресации для VLAN 1 на всех коммутаторах.
```
int vlan 1
ip address 192.168.1.1/2/3 255.255.255.0
no shutdown
exit
```
h.	Скопируем текущую конфигурацию в файл загрузочной конфигурации.
```
wr
```
#### Шаг 4:	Проверяем связь. Проверяем способность компьютеров обмениваться эхо-запросами.

эхо-запрос от коммутатора S1 на коммутатор S2
```
S1#ping 192.168.1.2

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.1.2, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 0/0/3 ms
```
эхо-запрос от коммутатора S1 на коммутатор S3
```
S1#ping 192.168.1.3

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.1.3, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 0/0/1 ms
```
эхо-запрос от коммутатора S2 на коммутатор S3
```
S2#ping 192.168.1.3

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 192.168.1.3, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 0/0/0 ms
```

#### Часть 2:	Определение корневого моста

#### Шаг 1:	Отключите все порты на коммутаторах.
Отправляем все порты в down командой ***shutdown***

#### Шаг 2:	Настройте подключенные порты в качестве транковых.
```
int range f0/1-4
switchport mode trunk
exit
```
#### Шаг 3:	Включите порты F0/2 и F0/4 на всех коммутаторах.
Включаем нужные порты командой ***no shutdown***

#### Шаг 4:	Отобразите данные протокола spanning-tree.

```
S1#show spanning-tree 
VLAN0001
  Spanning tree enabled protocol ieee
  Root ID    Priority    32769
             Address     0006.2A7B.3A44
             Cost        19
             Port        4(FastEthernet0/4)
             Hello Time  2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     00D0.FFA7.B486
             Hello Time  2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time  20

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/2            Altn BLK 19        128.2    P2p
Fa0/4            Root FWD 19        128.4    P2p
```
```
S2#sh spanning-tree 
VLAN0001
  Spanning tree enabled protocol ieee
  Root ID    Priority    32769
             Address     0006.2A7B.3A44
             Cost        19
             Port        4(FastEthernet0/4)
             Hello Time  2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     0090.216B.0DE9
             Hello Time  2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time  20

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/4            Root FWD 19        128.4    P2p
Fa0/2            Desg FWD 19        128.2    P2p
```
```
S3#sh spanning-tree 
VLAN0001
  Spanning tree enabled protocol ieee
  Root ID    Priority    32769
             Address     0006.2A7B.3A44
             This bridge is the root
             Hello Time  2 sec  Max Age 20 sec  Forward Delay 15 sec

  Bridge ID  Priority    32769  (priority 32768 sys-id-ext 1)
             Address     0006.2A7B.3A44
             Hello Time  2 sec  Max Age 20 sec  Forward Delay 15 sec
             Aging Time  20

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/2            Desg FWD 19        128.2    P2p
Fa0/4            Desg FWD 19        128.4    P2p
```

Примечание. Режим STP по умолчанию на коммутаторе 2960 — протокол STP для каждой сети VLAN (PVST).

В схему ниже запишите роль и состояние (Sts) активных портов на каждом коммутаторе в топологии.

![](https://github.com/irvin232/OTUS-network-engineer/blob/master/labs/lab02/scheme%202.png)
 
С учетом выходных данных, поступающих с коммутаторов, ответьте на следующие вопросы.
Какой коммутатор является корневым мостом? ______________
Почему этот коммутатор был выбран протоколом spanning-tree в качестве корневого моста?
_______________________________________________________________________________________
_______________________________________________________________________________________
Какие порты на коммутаторе являются корневыми портами? ___________________________________
Какие порты на коммутаторе являются назначенными портами? ________________________________
Какой порт отображается в качестве альтернативного и в настоящее время заблокирован? ____________________________
Почему протокол spanning-tree выбрал этот порт в качестве невыделенного (заблокированного) порта?
_______________________________________________________________________________________
_______________________________________________________________________________________
_______________________________________________________________________________________
_______________________________________________________________________________________


